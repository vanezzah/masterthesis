---
title: "Plots Interactions"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Calculate model
```{r}
table_numcarsregion <- as.data.frame(dplyr::count(HH_dt_2_out, numcars , by=region2)) #ok
table_numcarsregion <- reshape(table_numcarsregion, idvar = "numcars", timevar = "by", direction = "wide")
table_numcarsregion$n.urban <- table_numcarsregion$n.urban/26320
table_numcarsregion$n.suburban <- table_numcarsregion$n.suburban/30899
table_numcarsregion$n.rural <- table_numcarsregion$n.rural/13101

multinom_int3_temp <- multinom_int3

# Calculate model with interactions
# interactions are added for all terms other than bus, metro, CSmultiple, quali_opnv
# Nonlinear terms are added for all numerical variables
multinom_int3 <-multinom(formula = numcars ~ region2 + numlic + I(numlic^2) + 
    region2:numlic + region2:I(numlic^2) + income_numerical + 
    I(income_numerical^2) + region2:income_numerical + region2:I(income_numerical^2) +     quali_nv + region2:quali_nv + CSyes + region2:CSyes + workers + 
    I(workers^2) + region2:workers + region2:I(workers^2) + triplength_avg + 
    I(triplength_avg^2) + region2:triplength_avg + region2:I(triplength_avg^2) + 
    log(nummots1) + region2:log(nummots1) + housing_type + region2:housing_type + 
    garage + region2:garage + quali_opnv + 
    oldHH + region2:oldHH + CSmultiple + 
    hh_children + region2:hh_children + metro28 + 
    tripsavg + I(tripsavg^2) + region2:tripsavg + parttime + 
    I(parttime^2) + region2:parttime + train28 + region2:train28 + 
    numped + I(numped^2) + region2:numped + region2:I(numped^2) + 
    bus28, data = HH_dt_2_out, maxit = 700)

multinom_int <- multinom(numcars ~ region2 + numlic + I(numlic^2) + region2:numlic + region2:I(numlic^2) + income_numerical +I(income_numerical^2)+ region2:income_numerical + region2:I(income_numerical^2) + quali_nv + region2:quali_nv + CSyes + region2:CSyes + workers+ I(workers^2)+region2:workers +region2:I(workers^2)+ triplength_avg+ I(triplength_avg^2)+ region2:triplength_avg+ region2:I(triplength_avg^2) + log(nummots1) + region2:log(nummots1) +housing_type + region2:housing_type+ garage +region2:garage+ quali_opnv + region2:quali_opnv+oldHH + region2:oldHH +CSmultiple+region2:CSmultiple+ hh_children + region2:hh_children + metro28 + parttime + I(parttime^2) + region2:parttime+train28 + numped + I(numped^2) + region2:numped + region2:I(numped^2) + bus28, data = HH_dt_2_out, maxit=700)

multinom_int <- multinom(numcars ~ region2 + numlic + I(numlic^2) + region2:numlic + region2:I(numlic^2) + income_numerical +I(income_numerical^2)+ region2:income_numerical + region2:I(income_numerical^2) + quali_nv + region2:quali_nv+CSyes + region2:CSyes + workers+ I(workers^2)+ region2:workers + triplength_avg+ I(triplength_avg^2)+ region2:triplength_avg+ region2:I(triplength_avg^2) + log(nummots1) + housing_type + garage + quali_opnv + oldHH + region2:oldHH+ CSmultiple+ hh_children + region2:hh_children + metro28 + tripsavg + parttime + train28 +numped + I(numped^2) + region2:numped + region2:I(numped^2) +bus28, data = HH_dt_2_out, maxit=700)

fm_int <- formula(numcars ~ 1|region2 + numlic + I(numlic^2) + 
    region2:numlic + region2:I(numlic^2) + income_numerical + 
    I(income_numerical^2) + region2:income_numerical + region2:I(income_numerical^2)     +quali_nv + region2:quali_nv + CSyes + region2:CSyes + workers + 
    I(workers^2) + region2:workers + region2:I(workers^2) + triplength_avg + 
    I(triplength_avg^2) + region2:triplength_avg + region2:I(triplength_avg^2) + 
    log(nummots1) + region2:log(nummots1) + housing_type + region2:housing_type + 
    garage + region2:garage + quali_opnv + 
    oldHH + region2:oldHH + CSmultiple + 
    hh_children + region2:hh_children + metro28 + 
    tripsavg + I(tripsavg^2) + region2:tripsavg + parttime + 
    I(parttime^2) + region2:parttime + train28 + region2:train28 + 
    numped + I(numped^2) + region2:numped + region2:I(numped^2) + 
    bus28|1)

fit_int <- mnlogit(fm_int, mnlogit_dt_out, ncores=4, choiceVar = "alt")
```


```{r}
#substitution of coefficients
multinom_int2 <- multinom_int
cf2 <- matrix(multinom_int2$wts, nrow=71) # davor 39 
fit_interaction.cf <- coef(fit_interaction)
cf2[2:nrow(cf2), 2:ncol(cf2)] <- (matrix(fit_interaction.cf,nrow=3))

# Substitution of probabilities
multinom_int2$wts <- c(cf2)
multinom_int2$fitted.values <- fit_interaction$probabilities


```

Coefficient table interaction model

```{r}
options(scipen = 999)

summary_int <- summary(fit_int)
coeffs_int <- summary_int$CoefTable
coeffs_int <- as.data.frame(coeffs_int)
coeffs_int <- rownames_to_column(coeffs_int)
coeffs_int$`t-value` <- NULL

coeffs_int1 <- coeffs_int[seq(1, 279, by=3),]
coeffs_int2 <- coeffs_int[seq(2, 279, by=3),]
coeffs_int3 <- coeffs_int[seq(3, 279, by=3),]

coeffsint_total <- data.frame(coeffs_int1, coeffs_int2, coeffs_int3)
coeffsint_total$rowname.1 <- NULL
coeffsint_total$rowname.2 <- NULL

coeffsint_total$rowname<-  sub(":1", "", coeffsint_total$rowname)
coeffsint_total$rowname[coeffsint_total$rowname=="I(numlic^2)"] <- "licenses squared"
coeffsint_total$rowname[coeffsint_total$rowname=="I(parttime^2)"] <- "parttime squared"
coeffsint_total$rowname[coeffsint_total$rowname=="I(income_numerical^2)"] <- "income squared"
coeffsint_total$rowname[coeffsint_total$rowname=="I(triplength_avg^2)"] <- "av.triplength squared"
coeffsint_total$rowname[coeffsint_total$rowname=="log(nummots1)"] <- "motorbikes (log)"
coeffsint_total$rowname[coeffsint_total$rowname=="I(numped^2)"] <- "numped squared"
coeffsint_total$rowname[coeffsint_total$rowname=="I(workers^2)"] <- "workers squared"
coeffsint_total$rowname[coeffsint_total$rowname=="I(tripsavg^2)"] <- "tripsavg squared"

coeffsint_total$rowname[coeffsint_total$rowname=="numlic"] <- "licenses"
coeffsint_total$rowname[coeffsint_total$rowname=="income_numerical"] <- "income"
coeffsint_total$rowname[coeffsint_total$rowname=="triplength_avg"] <- "av.triplength"
coeffsint_total$rowname[coeffsint_total$rowname=="workers"] <- "fulltime"
coeffsint_total$rowname[coeffsint_total$rowname=="numped"] <- "bikes"
coeffsint_total$rowname[coeffsint_total$rowname=="tripsavg"] <- "av.trips"
coeffsint_total$rowname[coeffsint_total$rowname=="CSyes1"] <- "carsharing"
coeffsint_total$rowname[coeffsint_total$rowname=="CSmultiple1"] <- "m.carsharing"
coeffsint_total$rowname[coeffsint_total$rowname=="nummots"] <- "motorbikes"
coeffsint_total$rowname[coeffsint_total$rowname=="parttime"] <- "parttime"
coeffsint_total$rowname[coeffsint_total$rowname=="region2suburban"] <- "suburban"
coeffsint_total$rowname[coeffsint_total$rowname=="region2rural"] <- "rural"
coeffsint_total$rowname[coeffsint_total$rowname=="oldHH1"] <- "old"
coeffsint_total$rowname[coeffsint_total$rowname=="hh_children1"] <- "children"
coeffsint_total$rowname[coeffsint_total$rowname=="housing_typemultifamily_h"] <- "multifamily"
coeffsint_total$rowname[coeffsint_total$rowname=="housing_typeapartmentbuilding"] <- "apartmentbuilding"
coeffsint_total$rowname[coeffsint_total$rowname=="housing_typeother"] <- "other"
coeffsint_total$rowname[coeffsint_total$rowname=="garage1"] <- "garage"

coeffsint_total$rowname[coeffsint_total$rowname=="quali_nv2"] <- "ps.2"
coeffsint_total$rowname[coeffsint_total$rowname=="quali_nv3"] <- "ps.3"
coeffsint_total$rowname[coeffsint_total$rowname=="quali_nv4"] <- "ps.4"

coeffsint_total$rowname[coeffsint_total$rowname=="quali_opnv2"] <- "pt.2"
coeffsint_total$rowname[coeffsint_total$rowname=="quali_opnv3"] <- "pt.3"
coeffsint_total$rowname[coeffsint_total$rowname=="quali_opnv4"] <- "pt.4"

coeffsint_total$rowname[coeffsint_total$rowname=="bus28middle"] <- "bus.2"
coeffsint_total$rowname[coeffsint_total$rowname=="bus28far"] <- "bus.3"
coeffsint_total$rowname[coeffsint_total$rowname=="bus28rfar"] <- "bus.4"

coeffsint_total$rowname[coeffsint_total$rowname=="metro28middle"] <- "metro.2"
coeffsint_total$rowname[coeffsint_total$rowname=="metro28far"] <- "metro.3"
coeffsint_total$rowname[coeffsint_total$rowname=="metro28rfar"] <- "metro.4"

coeffsint_total$rowname <-  sub("region2suburban", "suburban", coeffsint_total$rowname)
coeffsint_total$rowname <-  sub("region2rural", "rural", coeffsint_total$rowname)

coeffsint_total$rowname <-  sub("train28rfar", "train.4", coeffsint_total$rowname)
coeffsint_total$rowname <-  sub("train28far", "train.3", coeffsint_total$rowname)
coeffsint_total$rowname <-  sub("train28middle", "train.2", coeffsint_total$rowname)

coeffsint_total$rowname <-  sub("quali_nv4", "ps.4", coeffsint_total$rowname)
coeffsint_total$rowname <-  sub("quali_nv3", "ps.3", coeffsint_total$rowname)
coeffsint_total$rowname <-  sub("quali_nv2", "ps.2", coeffsint_total$rowname)

colnames(coeffsint_total)<- c("Variable","Parameter","Std. Error", "Sig1.", "Parameter","Std. Error", "Sig2.", "Parameter","Std. Error", "Sig3.")

for(i in 1:93) {
  if (coeffsint_total$Sig1.[i] < 0.01) {
    coeffsint_total$Sig1.[i] <- "***"
  }
  else if (coeffsint_total$Sig1.[i] < 0.05) {
    coeffsint_total$Sig1.[i] <- "**"
  }
  else if (coeffsint_total$Sig1.[i] < 0.1) {
    coeffsint_total$Sig1.[i] <- "*"
  }
  
  else{
    coeffsint_total$Sig1.[i] <- ""
  }
}

for(i in 1:93) {
  if (coeffsint_total$Sig2.[i] < 0.01) {
    coeffsint_total$Sig2.[i] <- "***"
  }
  else if (coeffsint_total$Sig2.[i] < 0.05) {
    coeffsint_total$Sig2.[i] <- "**"
  }
   else if (coeffsint_total$Sig2.[i] < 0.1) {
    coeffsint_total$Sig2.[i] <- "*"
   }
  else{
    coeffsint_total$Sig2.[i] <- ""
  }
}


for(i in 1:93) {
  if (coeffsint_total$Sig3.[i] < 0.01) {
    coeffsint_total$Sig3.[i] <- "***"
  }
  else if (coeffsint_total$Sig3.[i] < 0.05) {
    coeffsint_total$Sig3.[i] <- "**"
  }
   else if (coeffsint_total$Sig3.[i] < 0.1) {
    coeffsint_total$Sig3.[i] <- "*"
   }
  else{
    coeffsint_total$Sig3.[i] <- ""
  }
 }


print(xtable(coeffsint_total, type = "latex",digits=c(0,0,3,3,0,3,3,0,3,3,0)),include.rownames=FALSE, file = "coeffsint_model.tex")
```


Model validation interaction model 
```{r}
# Waldtest
waldtest(fit_int, fit_null)

#Scoretest (using mlogit)
model1_int <- mlogit(numcars ~1|region2 + numlic + I(numlic^2) + 
    region2:numlic + region2:I(numlic^2) + income_numerical + 
    I(income_numerical^2) + region2:income_numerical + region2:I(income_numerical^2)     +quali_nv + region2:quali_nv + CSyes + region2:CSyes + workers + 
    I(workers^2) + region2:workers + region2:I(workers^2) + triplength_avg + 
    I(triplength_avg^2) + region2:triplength_avg + region2:I(triplength_avg^2) + 
    log(nummots1) + region2:log(nummots1) + housing_type + region2:housing_type + 
    garage + region2:garage + quali_opnv + 
    oldHH + region2:oldHH + CSmultiple + 
    hh_children + region2:hh_children + metro28 + 
    tripsavg + I(tripsavg^2) + region2:tripsavg + parttime + 
    I(parttime^2) + region2:parttime + train28 + region2:train28 + 
    numped + I(numped^2) + region2:numped + region2:I(numped^2) + 
    bus28|1, data = mnlogit_dt_out)
scoretest(model2, model_int)

# Likelihood ratio test
lrtest(fit_null, fit_int)

# AIC:
AIC(fit_int)
AIC(fit_null)

#Pseudo R-Squares
LL0 <- logLik(fit_null)
LL1 <- logLik(fit_int)
N <- nrow(HH_dt_2_out)

#mc fadden pseudo r2 
mcfadden_int <- as.vector(1 - ((LL1) / (LL0)))

# cox and snell r2 
cox_int <- as.vector(1 - exp((2/N) * (LL0 - LL1)))

# nagelkerke r2
nagelkerke_int <- as.vector((1 - exp((2/N) * (LL0 - LL1))) / (1 - exp((2/N)*LL0)))


```

Compute effects
```{r}
#compute and manipulate all effects
library(effects)
#qualinv4
ef <- effect("region2:quali_nv", multinom_int2) #nur rural and urban und nur 1 und 2
ef <- as.data.frame(ef)

#numlic
ef2 <- effect("region2:numlic", multinom_int)
ef2 <- as.data.frame(ef2)

eftest2 <- effect("region2:numlic", multinom_int)
eftest2 <- as.data.frame(eftest2)


#income_numerical
ef3 <- effect("region2:income_numerical", multinom_int2)#bei rural nicht 1
ef3 <- as.data.frame(ef3)

#Csyes
ef4 <- effect("region2:CSyes", multinom_int2) #nursuburban, alle
temp <- ef4
ef4 <- as.data.frame(ef4)


ef5 <- effect("region2:workers", multinom_int2) # alles 
ef5 <- as.data.frame(ef5)
ef12 <- effect("region2:parttime", multinom_int2) # alles 
ef12 <- as.data.frame(ef12)

ef6 <- effect("region2:triplength_avg", multinom_int2) #nur suburban significant, alle levels
ef6 <- as.data.frame(ef6)

ef7 <- effect("region2:oldHH", multinom_int2) #nur rural, alle levels
ef7 <- as.data.frame(ef7)

ef8 <- effect("region2:hh_children", multinom_int2) #nur carownership 2 bei suburban, 2 und 3 bei rural
ef8 <- as.data.frame(ef8)


ef9 <- effect("region2:numped", multinom_int2) #bei rural level1 nicht (2 plots)
ef9 <- as.data.frame(ef9)


ef10 <- effect("region2:quali_opnv", multinom_int2) #bei rural level1 nicht (2 plots)
ef10 <- as.data.frame(ef10)

ef11 <- effect("region2:CSmultiple", multinom_int2) #bei rural level1 nicht (2 plots)
ef11 <- as.data.frame(ef11)

ef13 <- effect("region2:housing_type", multinom_int2) #bei rural level1 nicht (2 plots)
ef13 <- as.data.frame(ef13)

ef19 <- effect("region2:garage", multinom_int) #bei rural level1 nicht (2 plots)
ef19 <- as.data.frame(ef19)

ef14 <- effect("region2:metro28", multinom_int2) #bei rural level1 nicht (2 plots)
ef14 <- as.data.frame(ef14)

ef15 <- effect("region2:train28", multinom_int2) #bei rural level1 nicht (2 plots)
ef15 <- as.data.frame(ef15)

eftest <- effect("region2:train28", multinom_int3) #bei rural level1 nicht (2 plots)
eftest <- as.data.frame(eftest)

ef16 <- effect("region2:bus28", multinom_int2) #bei rural level1 nicht (2 plots)
ef16 <- as.data.frame(ef16)

ef17 <- effect("region2:tripsavg", multinom_int2) #bei rural level1 nicht (2 plots)
ef17 <- as.data.frame(ef17)

ef18 <- effect("region2:log(nummots1)", multinom_int) #bei rural level1 nicht (2 plots)
ef18 <- as.data.frame(ef18)

#effects plot normal mit plot
#quali_nv4: only urban rural significantnand only for levels 0 vs.1 and 0 vs. 2, other qualinvs not significant
#ef$variables$qualinv4$levels <- c("0", "4")
#plot(ef, multiline=TRUE, x.var = "qualinv4", rug=FALSE, colors = c("blue", "red", "orange", "transparent"))

#numlic
#plot(ef2, multiline=TRUE, x.var = "numlic", rug=FALSE, colors = c("blue", "red", "orange", "black"))

#income_numerical
#plot(effect("region2:income_numerical", multinom_int2), multiline=TRUE, x.var = "income_numerical", rug=FALSE)

#levels(ef$x$C) <- c("foo", "bar")

#https://stackoverflow.com/questions/20530232/change-factor-labels-on-effects-plot-in-r
```

Interaction effects new

```{r}

#numlic
ef22 <- effect("region2:numlic", multinom_int3)
ef22 <- as.data.frame(ef22)

#income_numerical
ef33 <- effect("region2:income_numerical", multinom_int3)#bei rural nicht 1
ef33 <- as.data.frame(ef33)

#Csyes
ef44 <- effect("region2:CSyes", multinom_int3) #nursuburban, alle
ef44 <- as.data.frame(ef44)


#qualinv
ef111 <- effect("region2:quali_nv", multinom_int3) #nur rural and urban und nur 1 und 2
ef111 <- as.data.frame(ef111)
ef55 <- effect("region2:workers", multinom_int3) # alles 
ef55 <- as.data.frame(ef55)
ef122 <- effect("region2:parttime", multinom_int3) # alles 
ef122 <- as.data.frame(ef122)

ef66 <- effect("region2:triplength_avg", multinom_int3) #nur suburban significant, alle levels
ef66 <- as.data.frame(ef66)
ef77 <- effect("region2:oldHH", multinom_int3) #nur rural, alle levels
ef77 <- as.data.frame(ef77)
ef88 <- effect("region2:hh_children", multinom_int3) #nur carownership 2 bei suburban, 2 und 3 bei rural
ef88 <- as.data.frame(ef88)


ef99 <- effect("region2:numped", multinom_int3) #bei rural level1 nicht (2 plots)
ef99 <- as.data.frame(ef99)
ef133 <- effect("region2:housing_type", multinom_int3) #bei rural level1 nicht (2 plots)
ef133 <- as.data.frame(ef133)
ef199 <- effect("region2:garage", multinom_int3) #bei rural level1 nicht (2 plots)
ef199 <- as.data.frame(ef199)

ef155 <- effect("region2:train28", multinom_int3) #bei rural level1 nicht (2 plots)
ef155 <- as.data.frame(ef155)

ef177 <- effect("region2:tripsavg", multinom_int3) #bei rural level1 nicht (2 plots)
ef177 <- as.data.frame(ef177)

ef188 <- effect("region2:log(nummots1)", multinom_int3) #bei rural level1 nicht (2 plots)
ef188 <- as.data.frame(ef188)
```



Plots with ggplot - interaction terms
numlic
```{r}
#library(ggplot2)

#numlic 
Plot.numlic0<-ggplot(data=ef22, aes(x=numlic, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      #scale_color_manual(labels = c("urban","suburban", "rural"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=L.prob.X0, ymax=U.prob.X0),linetype=0,alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2)+
       ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      labs(color = "region") +
      coord_fixed(ratio=4)+
  scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.numlic0

Plot.numlic1<-ggplot(data=ef22, aes(x=numlic, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      #scale_color_manual(labels = c("urban","suburban", "rural"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=L.prob.X1, ymax=U.prob.X1),linetype=0,alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2)+
       ylab("")+
      xlab("")+
      ggtitle("One car")+
      labs(color = "region") +
      coord_fixed(ratio=4)+
  scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.numlic1

Plot.numlic2<-ggplot(data=ef22, aes(x=numlic, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      #scale_color_manual(labels = c("urban","suburban", "rural"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=L.prob.X2, ymax=U.prob.X2),linetype=0,alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2)+
       ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      labs(color = "region") +
     coord_fixed(ratio=4)+
  scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.numlic2

Plot.numlic3<-ggplot(data=ef22, aes(x=numlic, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      #scale_color_manual(labels = c("urban","suburban", "rural"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=L.prob.X3, ymax=U.prob.X3),linetype=0,alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2)+
      #geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2)+
       ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      labs(color = "region") +
      coord_fixed(ratio=4)+
    scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              legend.direction = "horizontal", 
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.numlic3

```

```{r}
figure_numlic <- ggarrange(Plot.numlic1, Plot.numlic2,Plot.numlic3,common.legend = TRUE, legend = "none",
          ncol = 3, nrow = 1)%>%gridExtra::grid.arrange(get_legend(Plot.numlic3), heights = unit(c(60, 5), "mm"))

figure_numlic <- ggarrange(Plot.numlic0, Plot.numlic1, Plot.numlic2,Plot.numlic3,common.legend = TRUE, legend = "none",
          ncol = 4, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.numlic3), heights = unit(c(50, 5), "mm"))

annotate_figure(figure_numlic,
                #top = text_grob("Number of license holders and region as predictors of car ownership", color = "black", size =                   14,),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Number of license holders", vjust = -11),
)

```

Income numerical

```{r}
#income (3 separate plot)
Plot.income0 <-ggplot(data=ef33, aes(x=income_numerical, group=region2, color=region2))+
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype=0)+
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      labs(color = "region") +
      coord_fixed(ratio=10)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.income0

Plot.income1 <-ggplot(data=ef33, aes(x=income_numerical, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype=0)+
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=10)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.income1

Plot.income2 <-ggplot(data=ef33, aes(x=income_numerical, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype=0)+
      ylab("")+
      xlab("")+
  labs(color = "region") +
      ggtitle("Two cars")+
      coord_fixed(ratio=10)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.income2


Plot.income3 <-ggplot(data=ef33, aes(x=income_numerical, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #geom_line(aes(y=prob.X3, color ="prob.X3"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype=0)+
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
  labs(color = "region") +
      coord_fixed(ratio=10)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
            legend.direction = "horizontal",  
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.income3

```

```{r}
figure_income <- ggarrange(Plot.income0, Plot.income1, Plot.income2, common.legend = TRUE, legend = "none", vjust=7,
          ncol = 3, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.income3), heights = unit(c(60, 5), "mm"))

figure_income <- ggarrange(Plot.income0, Plot.income1, Plot.income2,Plot.income3,common.legend = TRUE, legend = "none",
          ncol = 4, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.income3), heights = unit(c(50, 5), "mm"))

annotate_figure(figure_income,
                #top = text_grob("Monthly income and region as predictors of car ownership", color = "black", size =                   14, vjust=5),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Monthly Income in Thousands", vjust=-9),
)



```

qualinv
```{r}

library(ggplot2)
#qualinv4
Plot.qualinv1 <-ggplot(data=ef111, aes(x=quali_nv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=13.33)+
      scale_y_continuous(limits=c(0,0.3),breaks = c(0.1,0.2,0.3))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualinv1

Plot.qualinv2 <-ggplot(data=ef111, aes(x=quali_nv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualinv2

Plot.qualinv3 <-ggplot(data=ef111, aes(x=quali_nv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualinv3

Plot.qualinv4 <-ggplot(data=ef111, aes(x=quali_nv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=13.33)+
      scale_y_continuous(limits=c(0,0.3),breaks = c(0.1,0.2,0.3))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              legend.direction = "horizontal",
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualinv4
```

```{r}
#library(ggpubr)
figure <- ggarrange(Plot.qualinv1, Plot.qualinv2, Plot.qualinv3,common.legend = TRUE, legend = "none", vjust=8,
          ncol = 3, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.qualinv4), heights = unit(c(60, 5), "mm"))

library(dplyr)
library(gpubr)
figure <- ggarrange(Plot.qualinv1, Plot.qualinv2, Plot.qualinv3,Plot.qualinv4, common.legend = TRUE, legend = "none", vjust=8,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.qualinv4), heights = unit(c(50, 5), "mm"))

annotate_figure(figure,
                #top = text_grob("Quality of public services and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Quality of public services", vjust=-11),
)



```



quali_opnv # in rural und suburban from 1 to 2 not great difference, in urban already a difference between 1 and 2
```{r}
Plot.qualiopnv1 <-ggplot(data=ef10, aes(x=quali_opnv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=12)+
      scale_y_continuous(limits=c(0,0.3),breaks = c(0.1,0.2,0.3))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualiopnv1

Plot.qualiopnv2 <-ggplot(data=ef10, aes(x=quali_opnv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualiopnv2

Plot.qualiopnv3 <-ggplot(data=ef10, aes(x=quali_opnv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        legend.position="bottom",
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualiopnv3

Plot.qualiopnv4 <-ggplot(data=ef10, aes(x=quali_opnv, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              legend.direction = "horizontal",
              legend.position =c(0.35, 0.8),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.qualiopnv4
```

```{r}
figure1 <- ggarrange( Plot.qualinv1,Plot.qualinv2, Plot.qualinv3,legend="none",common.legend = TRUE,labels=c("     Zero cars",     "     One car", "     Two cars"), vjust=2,font.label = list(size = 10, just="left"),
          ncol = 3, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.qualiopnv3), heights = unit(c(60, 5), "mm"))

annotate_figure(figure1,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Quality of public services", vjust=-11),
)

figure2 <- ggarrange( Plot.qualiopnv1,Plot.qualiopnv2, Plot.qualiopnv3,legend="none",common.legend = TRUE,labels=c("     Zero cars",     "     One car", "     Two cars"), vjust=4,font.label = list(size = 10, just="left"),
          ncol = 4, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.qualiopnv4), heights = unit(c(60, 5), "mm"))

annotate_figure(figure2,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Quality of public transport", vjust=-11, just="right"),
)





```


Csyes
```{r}
#CSyes
Plot.cs0 <-ggplot(data=ef44, aes(x=CSyes, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),aspect.ratio=1)+
      scale_fill_grey()
Plot.cs0

Plot.cs1 <-ggplot(data=ef44, aes(x=CSyes, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.cs1


Plot.cs2 <-ggplot(data=ef44, aes(x=CSyes, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.cs2

Plot.cs3<-ggplot(data=ef44, aes(x=CSyes, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
  labs(color = "region")+
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              legend.direction = "horizontal",
        panel.grid.minor=element_blank(), aspect.ratio=1)+
      scale_fill_grey()
Plot.cs3
```

```{r}
figure_car <- ggarrange(Plot.cs0, Plot.cs1, Plot.cs2,common.legend = TRUE, legend = "none", vjust=8,
          ncol = 3, nrow = 1)%>%gridExtra::grid.arrange(get_legend(Plot.cs3), heights = unit(c(60, 5), "mm"))

figure_car <- ggarrange(Plot.cs0, Plot.cs1, Plot.cs2,Plot.cs3,common.legend = TRUE, legend = "none", vjust=8,
          ncol = 4, nrow = 1)%>%gridExtra::grid.arrange(get_legend(Plot.cs3), heights = unit(c(60, 5), "mm"))

annotate_figure(figure_car,
                #top = text_grob("Carsharing and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Carsharing Subscription", vjust=-9),
)



```

workers
```{r}
#CSyes
Plot.work0 <-ggplot(data=ef55, aes(x=workers, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      labs(color = "region") +
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4))+
  coord_fixed(ratio=6)+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.work0

Plot.work1 <-ggplot(data=ef55, aes(x=workers, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  coord_fixed(ratio=3)+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.work1

Plot.work2 <-ggplot(data=ef55, aes(x=workers, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
  coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.work2

Plot.work3<-ggplot(data=ef55, aes(x=workers, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
  labs(color = "region")+
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              legend.direction = "horizontal",
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.work3
```

```{r}
figure_work <- ggarrange(Plot.work1, Plot.work2, Plot.work3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 3, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))

figure_work <- ggarrange(Plot.work0, Plot.work1, Plot.work2, Plot.work3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))


annotate_figure(figure_work,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Number of fulltime workers", vjust=-9),
)
```

parttime

```{r}
Plot.parttime1 <-ggplot(data=ef122, aes(x=parttime, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()

Plot.parttime2 <-ggplot(data=ef122, aes(x=parttime, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()


Plot.parttime3 <-ggplot(data=ef122, aes(x=parttime, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()

Plot.parttime4 <-ggplot(data=ef122, aes(x=parttime, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
```

```{r}
figure_parttime <- ggarrange(Plot.parttime1,Plot.parttime2, Plot.parttime3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 3, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.qualiopnv3), heights = unit(c(60, 5), "mm"))


annotate_figure(figure_parttime,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Number of parttime workers", vjust=-9),
)

```
triplength_avg
```{r}
Plot.trip0 <-ggplot(data=ef66, aes(x=triplength_avg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=30)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.trip0

Plot.trip1 <-ggplot(data=ef66, aes(x=triplength_avg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=30)+
      labs(color = "region") +
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.trip1

Plot.trip2 <-ggplot(data=ef66, aes(x=triplength_avg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=30)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.trip2

Plot.trip3<-ggplot(data=ef66, aes(x=triplength_avg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=30)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.trip3

```

```{r}
figure_trip <- ggarrange(Plot.trip1, Plot.trip2, common.legend = TRUE, legend = "right", vjust=5,
          ncol = 2, nrow = 1)

figure_trip <- ggarrange(Plot.trip0,Plot.trip1, Plot.trip2, Plot.trip3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))


annotate_figure(figure_trip,
                #top = text_grob("Average triplength and region as predictors of car ownership", color = "black", size = 14, vjust=4),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Average triplength in kilometers", vjust=-6),
)
```

Share old

```{r}
Plot.share0 <-ggplot(data=ef77, aes(x=oldHH, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region")+
       ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=4)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4))+
   scale_x_discrete(labels = c("0" = "<= 36", "1" = "> 36"))+
      #scale_x_continuous(limits=c(0,1),breaks = c(0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.share0

Plot.share1 <-ggplot(data=ef77, aes(x=oldHH, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      labs(color = "region") +
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
scale_x_discrete(labels = c("0" = "<= 36", "1" = "> 36"))+      #scale_x_continuous(limits=c(0,1),breaks = c(0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.share1

Plot.share2 <-ggplot(data=ef77, aes(x=oldHH, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) +
      labs(color = "region")+
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=2)+
scale_x_discrete(labels = c("0" = "<= 36", "1" = "> 36"))+      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      #scale_x_continuous(limits=c(0,1),breaks = c(0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()


Plot.share3<-ggplot(data=ef77, aes(x=oldHH, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      labs(color = "region")+
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=4)+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      labs(color = "region")+
scale_x_discrete(labels = c("0" = "<= 36", "1" = "> 36"))+      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4))+
      #scale_x_continuous(limits=c(0,1),breaks = c(0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.share3
```

```{r}

figure_share <- ggarrange(Plot.share0,Plot.share1, Plot.share2, Plot.share3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))

figure_share <- ggarrange(Plot.share0, Plot.share1, Plot.share2, common.legend = TRUE, legend = "none", vjust=5,
          ncol = 3, nrow = 1)%>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))


annotate_figure(figure_share,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Prevailing household age", vjust=-9),
)
```


hh_children
```{r}
Plot.children0 <-ggplot(data=ef88, aes(x=hh_children, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      labs(color = "region")+
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=8)+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45, hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.children0

Plot.children1 <-ggplot(data=ef88, aes(x=hh_children, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
  labs(color = "region")+
      ggtitle("One car")+
      coord_fixed(ratio=2)+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45, hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.children1

Plot.children2 <-ggplot(data=ef88, aes(x=hh_children, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=2)+
  labs(color = "region")+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45, hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.children2

Plot.children3<-ggplot(data=ef88, aes(x=hh_children, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
       ylab("")+
      xlab("")+
      ggtitle("Three cars")+
  labs(color = "region")+
      coord_fixed(ratio=8)+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+ 
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45, hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.children3
```

```{r}
figure_children <- ggarrange(Plot.children1, Plot.children2, common.legend = TRUE, legend = "right", vjust=8,
          ncol = 2, nrow = 1)


figure_children <- ggarrange(Plot.children0, Plot.children1, Plot.children2, Plot.children3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))

annotate_figure(figure_children,
                #top = text_grob("Children and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Household with children", vjust=-5),
)
```


numped
```{r}
Plot.ped0 <-ggplot(data=ef99, aes(x=numped, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
  labs(color = "region")+
      coord_fixed(ratio=20)+
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
   scale_x_continuous(limits=c(0,5),breaks = c(0,1,2,3,4,5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.ped0

Plot.ped1 <-ggplot(data=ef99, aes(x=numped, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("One car")+
  labs(color = "region")+
      coord_fixed(ratio=5)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_continuous(limits=c(0,5),breaks = c(0,1,2,3,4,5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.ped1

Plot.ped2 <-ggplot(data=ef99, aes(x=numped, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
  labs(color = "region")+
      coord_fixed(ratio=5)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_continuous(limits=c(0,5),breaks = c(0,1,2,3,4,5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.ped2

Plot.ped3<-ggplot(data=ef99, aes(x=numped, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
  labs(color = "region")+
      coord_fixed(ratio=20)+
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
  scale_x_continuous(limits=c(0,5),breaks = c(0,1,2,3,4,5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.ped3
```

```{r}
figure_ped <- ggarrange(Plot.ped1, Plot.ped2, common.legend = TRUE, legend = "right", vjust=8,
          ncol = 2, nrow = 1)

figure_ped <- ggarrange(Plot.ped0, Plot.ped1, Plot.ped2,Plot.ped3,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))


annotate_figure(figure_ped,
                #top = text_grob("Number of bicycles and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Number of bicycles/pedelecs", vjust=-5),
)
```

housingtype

```{r}
Plot.housingtyp1 <-ggplot(data=ef133, aes(x=housing_type, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=6)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4))+
  scale_x_discrete(limits=c("singlefamily_h","multifamily_h", "apartmentbuilding"),labels = c("singlefamily_h" = "Singlefamily-Home", "multifamily_h" = "Multifamily-Home","apartmentbuilding" = "Apartmentbuilding"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45,hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()

Plot.housingtyp2 <-ggplot(data=ef133, aes(x=housing_type, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_discrete(limits=c("singlefamily_h","multifamily_h", "apartmentbuilding"),labels = c("singlefamily_h" = "Singlefamily-Home", "multifamily_h" = "Multifamily-Home","apartmentbuilding" = "Apartmentbuilding"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45,hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()


Plot.housingtyp3 <-ggplot(data=ef133, aes(x=housing_type, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=3)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_discrete(limits=c("singlefamily_h","multifamily_h", "apartmentbuilding"),labels = c("singlefamily_h" = "Singlefamily-Home", "multifamily_h" = "Multifamily-Home","apartmentbuilding" = "Apartmentbuilding"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45,hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()

Plot.housingtyp4 <-ggplot(data=ef133, aes(x=housing_type, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=6)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4))+
  scale_x_discrete(limits=c("singlefamily_h","multifamily_h", "apartmentbuilding"),labels = c("singlefamily_h" = "Singlefamily-Home", "multifamily_h" = "Multifamily-Home","apartmentbuilding" = "Apartmentbuilding"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
              axis.text.x = element_text(angle=45,hjust=1),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
```

```{r}
figure_housing <- ggarrange(Plot.housingtyp1, Plot.housingtyp2, Plot.housingtyp3,common.legend = TRUE, legend = "none", vjust=6,
          ncol = 3, nrow = 1, align = "h")

figure_housing <- ggarrange(Plot.housingtyp1, Plot.housingtyp2, Plot.housingtyp3,Plot.housingtyp4,common.legend = TRUE, legend = "none",vjust=3,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))

annotate_figure(figure_housing,
                left = text_grob("Predicted Probability", color = "black", rot = 90, hjust = 0.2),
                bottom = text_grob("Type of housing", color = "black",vjust=-4)
)

```

garage
```{r}
Plot.garage1 <-ggplot(data=ef199, aes(x=garage, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Zero cars")+
      coord_fixed(ratio=8)+
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+ 
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()

Plot.garage2 <-ggplot(data=ef199, aes(x=garage, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("One car")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+ 
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()


Plot.garage3 <-ggplot(data=ef199, aes(x=garage, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
     labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Two cars")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+ 
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()



Plot.garage4 <-ggplot(data=ef199, aes(x=garage, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("Three cars")+
      coord_fixed(ratio=8)+
      scale_y_continuous(limits=c(0,0.25),breaks = c(0.1,0.2))+
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+ 
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
```

```{r}
figure_garage <- ggarrange(Plot.garage2, Plot.garage3,common.legend = TRUE, legend = "right", vjust=8,
          ncol = 2 , nrow = 1)

annotate_figure(figure_garage,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Availability of a garage", vjust=-6),
)

figure_garage <- ggarrange(Plot.garage1, Plot.garage2, Plot.garage3,Plot.garage4, common.legend = TRUE, legend = "none", vjust=9,
          ncol = 4, nrow = 1) %>% gridExtra::grid.arrange(get_legend(Plot.work3), heights = unit(c(60, 5), "mm"))

annotate_figure(figure_garage,
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Availabilty of a garage", color = "black",vjust=-6)
)

```



Not shown in thesis:

CS multiple

```{r}
Plot.csm0 <-ggplot(data=ef11, aes(x=CSmultiple, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),aspect.ratio=1)+
      scale_fill_grey()
#Plot.csm0

Plot.csm1 <-ggplot(data=ef11, aes(x=CSmultiple, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm1


Plot.csm2 <-ggplot(data=ef11, aes(x=CSmultiple, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm2

Plot.csm3<-ggplot(data=ef11, aes(x=CSmultiple, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(), aspect.ratio=1)+
      scale_fill_grey()
#Plot.cs3

```

```{r}
figure <- ggarrange(Plot.csm0, Plot.csm1, Plot.csm2,Plot.csm3,common.legend = TRUE, legend = "right", 
          labels = c("Zero cars", "One car", "Two cars"), vjust=8,
          ncol = 4, nrow = 1)

annotate_figure(figure,
                top = text_grob("Carsharing and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Carsharing Subscription", vjust=-8),
)


```

trips
```{r}
Plot.tripsa0 <-ggplot(data=ef177, aes(x=tripsavg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),aspect.ratio=1)+
      scale_fill_grey()
Plot.tripsa0

Plot.tripsa1 <-ggplot(data=ef177, aes(x=tripsavg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.tripsa1


Plot.tripsa2 <-ggplot(data=ef177, aes(x=tripsavg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
Plot.tripsa2

Plot.tripsa3<-ggplot(data=ef177, aes(x=tripsavg, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(), aspect.ratio=1)+
      scale_fill_grey()
Plot.tripsa3

```


log(nummots)

```{r}
Plot.mot0 <-ggplot(data=ef188, aes(x=nummots1, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),aspect.ratio=1)+
      scale_fill_grey()
#Plot.mot0

Plot.mot1 <-ggplot(data=ef188, aes(x=nummots1, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm1


Plot.mot2 <-ggplot(data=ef188, aes(x=nummots1, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm2

Plot.mot3<-ggplot(data=ef188, aes(x=nummots1, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(), aspect.ratio=1)+
      scale_fill_grey()
Plot.mot0
Plot.mot1
Plot.mot2
Plot.mot3

```

```{r}
figure <- ggarrange(Plot.mot0, Plot.mot1, Plot.mot2,Plot.mot3,common.legend = TRUE, legend = "right", 
          labels = c("Zero cars", "One car", "Two cars"), vjust=8,
          ncol = 4, nrow = 1)

annotate_figure(figure,
                top = text_grob("Carsharing and region as predictors of car ownership", color = "black", size = 14, vjust=6),
                left = text_grob("Predicted Probability", color = "black", rot = 90),
                bottom = text_grob("Carsharing Subscription", vjust=-8),
)



```

```{r}
Plot.train0 <-ggplot(data=ef155, aes(x=train28, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X0)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X0-se.prob.X0, ymax=prob.X0+se.prob.X0),alpha=.2, linetype =0)+
      labs(color = "region") +
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,0.5),breaks = c(0.1,0.2,0.3,0.4,0.5))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),aspect.ratio=1)+
      scale_fill_grey()
#Plot.mot0

Plot.train1 <-ggplot(data=ef155, aes(x=train28, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X1)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X1-se.prob.X1, ymax=prob.X1+se.prob.X1),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      scale_x_discrete(labels = c("0" = "No", "1" = "Yes"))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm1


Plot.train2 <-ggplot(data=ef155, aes(x=train28, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X2)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X2-se.prob.X2, ymax=prob.X2+se.prob.X2),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      coord_fixed(ratio=2)+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank())+
      scale_fill_grey()
#Plot.csm2

Plot.train3<-ggplot(data=ef155, aes(x=train28, group=region2, color=region2))+
#For ylim, specify the range of your DV (in our case, 0-4)
      #facet_wrap(~region2)+
      geom_line(aes(y=prob.X3)) + 
      #geom_line(aes(y=prob.X1, color="prob.X1")) + 
      #geom_line(aes(y=prob.X2, color ="prob.X2"))+
      #scale_color_manual(labels = c("0 car","1 car", "2 cars"),values= c("blue", "red", "orange"))+
      geom_ribbon(aes(ymin=prob.X3-se.prob.X3, ymax=prob.X3+se.prob.X3),alpha=.2, linetype =0)+
      ylab("")+
      xlab("")+
      ggtitle("")+
      scale_y_continuous(limits=c(0,1),breaks = c(0.2,0.4,0.6,0.8))+
      theme_bw()+ 
        theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(), aspect.ratio=1)+
      scale_fill_grey()
Plot.train0
Plot.train1
Plot.train2
Plot.train3
```

